{"version":3,"sources":["styles/theme.js","../../src/hooks/useAcquireToken.js","../../src/NavigationClient.js","../../src/MsalWrapper.js","ui-components/WelcomeName.jsx","ui-components/SignInButton.jsx","ui-components/SignOutButton.jsx","ui-components/SignInSignOutButton.jsx","styles/useStyles.js","ui-components/NavBar.jsx","ui-components/PageLayout.jsx","pages/Home.jsx","authConfig.js","apiConfig.js","ui-components/ProfileData.jsx","ui-components/Loading.jsx","ui-components/ErrorComponent.jsx","pages/Profile.jsx","../../src/hooks/useGraph.js","App.js","index.js"],"names":["theme","createMuiTheme","palette","primary","main","secondary","error","red","A400","background","default","useAcquireToken","scopes","useMsal","accounts","useState","useEffect","a","inProgress","instance","account","response","setAccessToken","getData","accessToken","constructor","navigateInternal","relativePath","url","window","options","this","MsalWrapper","children","navigationClient","config","event","EventType","WelcomeName","name","setName","length","split","Typography","variant","SignInButton","anchorEl","setAnchorEl","open","Boolean","handleLogin","loginType","loginPopup","loginRedirect","Button","onClick","currentTarget","color","Menu","id","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","onClose","MenuItem","key","SignOutButton","handleLogout","logoutType","logoutPopup","logoutRedirect","IconButton","SignInSignOutButton","useIsAuthenticated","useStyles","makeStyles","root","flexGrow","menuButton","marginRight","spacing","title","NavBar","classes","className","AppBar","position","Toolbar","Link","component","RouterLink","to","PageLayout","props","Home","router","useHistory","isAuthenticated","push","ButtonGroup","orientation","ua","navigator","userAgent","msie","indexOf","msie11","msedge","firefox","msalConfig","auth","clientId","authority","redirectUri","postLogoutRedirectUri","cache","storeAuthStateInCookie","system","loggerOptions","loggerCallback","level","message","containsPii","LogLevel","Error","console","Info","info","Verbose","debug","Warning","warn","loginRequest","apiConfig","apiURL","ProfileData","graphData","List","displayName","jobTitle","mail","phone","businessPhones","location","officeLocation","NameListItem","ListItem","ListItemAvatar","Avatar","ListItemText","JobTitleListItem","MailListItem","PhoneListItem","LocationListItem","Loading","ErrorComponent","errorCode","ProfileContent","graphEndpoint","useCallback","fetch","method","headers","Authorization","signal","controller","body","setGraphData","setError","useGraph","accessGranted","setAccessGranted","data","setData","errorApi","setErrorApi","AbortController","json","claims","getDataFromApi","abort","Paper","style","textAlign","JSON","stringify","Profile","authRequest","interactionType","InteractionType","Popup","authenticationRequest","errorComponent","loadingComponent","msalInstance","PublicClientApplication","Pages","path","App","history","ThemeProvider","instanceConfig","Grid","container","justify","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.027bcd1d.chunk.js","sourcesContent":["import { unstable_createMuiStrictModeTheme as createMuiTheme } from '@material-ui/core/styles';\nimport red from '@material-ui/core/colors/red';\n\n// Create a theme instance.\nexport const theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#556cd6',\n    },\n    secondary: {\n      main: '#19857b',\n    },\n    error: {\n      main: red.A400,\n    },\n    background: {\n      default: '#fff',\n    },\n  },\n});\n","import { useEffect, useState } from 'react';\nimport { useMsal } from '@azure/msal-react';\n\nfunction useAcquireToken({ scopes = ['User.Read'] }) {\n  const { instance, inProgress, accounts } = useMsal();\n  const [accessToken, setAccessToken] = useState(null);\n\n  useEffect(() => {\n    const getData = async () => {\n      if (inProgress === 'none' && accounts.length > 0) {\n        // Retrieve an access token\n        try {\n          const response = await instance.acquireTokenSilent({\n            account: accounts[0],\n            scopes\n          });\n\n          if (response.accessToken) {\n            // console.info({ response });\n            setAccessToken(response.accessToken);\n            return;\n          }\n          setAccessToken(null);\n        } catch (error) {\n          if (accessToken) setAccessToken(null);\n        }\n      }\n    };\n\n    getData();\n  }, [accessToken, accounts, inProgress, instance, scopes]);\n\n  return { accessToken };\n}\n\nexport default useAcquireToken;\n","import { NavigationClient } from '@azure/msal-browser';\n\n/**\n * This is an example for overriding the default function MSAL uses to navigate to other urls in your webpage\n */\nexport class CustomNavigationClient extends NavigationClient {\n  constructor(router) {\n    super();\n    this.router = router;\n  }\n\n  /**\n   * Navigates to other pages within the same web application\n   * You can use the useRouter hook provided by next.js to take advantage of client-side routing\n   * @param url\n   * @param options\n   */\n  async navigateInternal(url, options) {\n    const relativePath = url.replace(window.location.origin, '');\n    if (options.noHistory) {\n      this.router.replace(relativePath);\n    } else {\n      this.router.push(relativePath);\n    }\n\n    return false;\n  }\n}\n","import React from 'react';\nimport { EventType } from '@azure/msal-browser';\nimport { MsalProvider } from '@azure/msal-react';\nimport { CustomNavigationClient } from './NavigationClient';\n\nconst MsalWrapper = ({ instance, config, children }) => {\n  // console.log({ instance, config });\n  const navigationClient = new CustomNavigationClient(config.router);\n  instance.setNavigationClient(navigationClient);\n\n  // Account selection logic is app dependent. Adjust as needed for different use cases.\n  const accounts = instance.getAllAccounts();\n  if (accounts.length > 0) {\n    // console.log(accounts);\n    instance.setActiveAccount(accounts[0]);\n  }\n\n  instance.addEventCallback((event) => {\n    if (event.eventType === EventType.LOGIN_SUCCESS && event.payload.account) {\n      const account = event.payload.account;\n      instance.setActiveAccount(account);\n    }\n  });\n\n  return <MsalProvider instance={instance}>{children}</MsalProvider>;\n};\n\nexport default MsalWrapper;\n","import React, { useEffect, useState } from 'react';\nimport { useMsal } from '@azure/msal-react';\nimport Typography from '@material-ui/core/Typography';\n\nconst WelcomeName = () => {\n  const { accounts } = useMsal();\n  const [name, setName] = useState(null);\n\n  useEffect(() => {\n    if (accounts.length > 0) {\n      setName(accounts[0].name.split(' ')[0]);\n    }\n  }, [accounts]);\n\n  if (name) {\n    return <Typography variant='h6'>Welcome, {name}</Typography>;\n  } else {\n    return null;\n  }\n};\n\nexport default WelcomeName;\n","import React, { useState } from \"react\";\nimport { useMsal } from \"@azure/msal-react\";\nimport Button from \"@material-ui/core/Button\";\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Menu from '@material-ui/core/Menu';\n\nexport const SignInButton = () => {\n    const { instance } = useMsal();\n\n    const [anchorEl, setAnchorEl] = useState(null);\n    const open = Boolean(anchorEl);\n\n    const handleLogin = (loginType) => {\n        setAnchorEl(null);\n\n        if (loginType === \"popup\") {\n            instance.loginPopup();\n        } else if (loginType === \"redirect\") {\n            instance.loginRedirect();\n        }\n    }\n\n    return (\n        <div>\n            <Button\n                onClick={(event) => setAnchorEl(event.currentTarget)}\n                color=\"inherit\"\n            >\n                Login\n            </Button>\n            <Menu\n                id=\"menu-appbar\"\n                anchorEl={anchorEl}\n                anchorOrigin={{\n                vertical: 'top',\n                horizontal: 'right',\n                }}\n                keepMounted\n                transformOrigin={{\n                vertical: 'top',\n                horizontal: 'right',\n                }}\n                open={open}\n                onClose={() => setAnchorEl(null)}\n            >\n                <MenuItem onClick={() => handleLogin(\"popup\")} key=\"loginPopup\">Sign in using Popup</MenuItem>\n                <MenuItem onClick={() => handleLogin(\"redirect\")} key=\"loginRedirect\">Sign in using Redirect</MenuItem>\n            </Menu>\n        </div>\n    )\n};\n","import React, { useState } from 'react';\nimport { useMsal } from '@azure/msal-react';\nimport IconButton from '@material-ui/core/IconButton';\nimport AccountCircle from '@material-ui/icons/AccountCircle';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Menu from '@material-ui/core/Menu';\n\nexport const SignOutButton = () => {\n  const { instance } = useMsal();\n\n  const [anchorEl, setAnchorEl] = useState(null);\n  const open = Boolean(anchorEl);\n\n  const handleLogout = (logoutType) => {\n    setAnchorEl(null);\n\n    if (logoutType === 'popup') {\n      instance.logoutPopup();\n    } else if (logoutType === 'redirect') {\n      instance.logoutRedirect();\n    }\n  };\n\n  return (\n    <div>\n      <IconButton\n        onClick={(event) => setAnchorEl(event.currentTarget)}\n        color='inherit'\n      >\n        <AccountCircle />\n      </IconButton>\n      <Menu\n        id='menu-appbar'\n        anchorEl={anchorEl}\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'right'\n        }}\n        keepMounted\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'right'\n        }}\n        open={open}\n        onClose={() => setAnchorEl(null)}\n      >\n        <MenuItem onClick={() => handleLogout('popup')} key='logoutPopup'>\n          Logout using Popup\n        </MenuItem>\n        <MenuItem onClick={() => handleLogout('redirect')} key='logoutRedirect'>\n          Logout using Redirect\n        </MenuItem>\n      </Menu>\n    </div>\n  );\n};\n","import React from 'react';\nimport { useIsAuthenticated } from \"@azure/msal-react\";\nimport { SignInButton } from \"./SignInButton\";\nimport { SignOutButton } from \"./SignOutButton\";\n\nconst SignInSignOutButton = () => {\n    const isAuthenticated = useIsAuthenticated();\n\n    if (isAuthenticated) {\n        return <SignOutButton />;\n    } else {\n        return <SignInButton />;\n    }\n}\n\nexport default SignInSignOutButton;\n","import { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n      flexGrow: 1,\n    },\n    menuButton: {\n      marginRight: theme.spacing(2),\n    },\n    title: {\n      flexGrow: 1,\n    },\n}));\n\nexport default useStyles;","import React from 'react';\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Toolbar from \"@material-ui/core/Toolbar\";\nimport Link from \"@material-ui/core/Link\";\nimport Typography from \"@material-ui/core/Typography\";\nimport WelcomeName from \"./WelcomeName\";\nimport SignInSignOutButton from \"./SignInSignOutButton\";\nimport useStyles from \"../styles/useStyles\";\nimport { Link as RouterLink } from \"react-router-dom\";\n\nconst NavBar = () => {\n    const classes = useStyles();\n\n    return (\n        <div className={classes.root}>\n            <AppBar position=\"static\">\n            <Toolbar>\n                <Typography className={classes.title}>\n                    <Link component={RouterLink} to=\"/\" color=\"inherit\" variant=\"h6\">MS Identity Platform</Link>\n                </Typography>\n                <WelcomeName />\n                <SignInSignOutButton />\n            </Toolbar>\n            </AppBar>\n        </div>\n    );\n};\n\nexport default NavBar;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport NavBar from './NavBar';\n\nexport const PageLayout = (props) => {\n  return (\n    <>\n      <NavBar />\n      <Typography variant='h5'>\n        <center>\n          Welcome to the Microsoft Authentication Library For React Quickstart\n        </center>\n      </Typography>\n      <br />\n      <br />\n      {props.children}\n    </>\n  );\n};\n","import React, { useEffect } from 'react';\nimport {\n  AuthenticatedTemplate,\n  UnauthenticatedTemplate,\n  useIsAuthenticated\n} from '@azure/msal-react';\nimport Button from '@material-ui/core/Button';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport Typography from '@material-ui/core/Typography';\nimport { Link as RouterLink, useHistory } from 'react-router-dom';\n\nexport function Home() {\n  const router = useHistory();\n  const isAuthenticated = useIsAuthenticated();\n\n  useEffect(() => {\n    if (isAuthenticated) router.push('/profile');\n  }, [router, isAuthenticated]);\n\n  return (\n    <>\n      <AuthenticatedTemplate>\n        <ButtonGroup orientation='vertical'>\n          <Button\n            component={RouterLink}\n            to='/profile'\n            variant='contained'\n            color='primary'\n          >\n            Request Profile Information\n          </Button>\n          <Button\n            component={RouterLink}\n            to='/profileWithMsal'\n            variant='contained'\n            color='primary'\n          >\n            Request Profile Information (using withMsal HOC)\n          </Button>\n          <Button\n            component={RouterLink}\n            to='/profileRawContext'\n            variant='contained'\n            color='primary'\n          >\n            Request Profile Information (using raw context\n          </Button>\n        </ButtonGroup>\n      </AuthenticatedTemplate>\n\n      <UnauthenticatedTemplate>\n        <Typography variant='h6'>\n          <center>Please sign-in to see your profile information.</center>\n        </Typography>\n      </UnauthenticatedTemplate>\n    </>\n  );\n}\n","import { LogLevel } from \"@azure/msal-browser\";\n// Browser check variables\n// If you support IE, our recommendation is that you sign-in using Redirect APIs\n// If you as a developer are testing using Edge InPrivate mode, please add \"isEdge\" to the if check\nconst ua = window.navigator.userAgent;\nconst msie = ua.indexOf(\"MSIE \");\nconst msie11 = ua.indexOf(\"Trident/\");\nconst msedge = ua.indexOf(\"Edge/\");\nconst firefox = ua.indexOf(\"Firefox\");\nconst isIE = msie > 0 || msie11 > 0;\nconst isEdge = msedge > 0;\nconst isFirefox = firefox > 0; // Only needed if you need to support the redirect flow in Firefox incognito\n\n// Config object to be passed to Msal on creation\nexport const msalConfig = {\n  auth: {\n    clientId: \"bb0c73e2-ab5e-409e-8e0f-7f253799a59d\",\n    authority: \"https://login.microsoftonline.com/4d0f4d8e-0fbd-4380-a076-4b6b2a83ce42/\",\n    redirectUri: \"/profile\",\n    postLogoutRedirectUri: \"/\"\n  },\n  cache: {\n    storeAuthStateInCookie: isIE || isEdge || isFirefox\n  },\n  system: {\n    loggerOptions: {\n      loggerCallback: (level, message, containsPii) => {\n        if (containsPii) {\n          return;\n        }\n        switch (level) {\n          case LogLevel.Error:\n            console.error(message);\n            return;\n          case LogLevel.Info:\n            console.info(message);\n            return;\n          case LogLevel.Verbose:\n            console.debug(message);\n            return;\n          case LogLevel.Warning:\n            console.warn(message);\n            return;\n          default:\n            return;\n        }\n      }\n    }\n  }\n};\n\n// Add here scopes for id token to be used at MS Identity Platform endpoints.\nexport const loginRequest = {\n  scopes: [\"User.Read\"]\n};\n\n// Add here the endpoints for MS Graph API services you would like to use.\nexport const graphConfig = {\n  graphMeEndpoint: \"https://graph.microsoft.com/v1.0/me\"\n};\n","export const apiConfig = {\n  apiURL: 'https://192.168.16.157:3001/api/tests/middleware/passport',\n  scopes: [\n    \"api://bb0c73e2-ab5e-409e-8e0f-7f253799a59d/sikur.read.all\",\n    \"api://bb0c73e2-ab5e-409e-8e0f-7f253799a59d/sikur.write.all\"\n  ]\n};\n","import React from \"react\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport PersonIcon from '@material-ui/icons/Person';\nimport WorkIcon  from \"@material-ui/icons/Work\";\nimport MailIcon from '@material-ui/icons/Mail';\nimport PhoneIcon from '@material-ui/icons/Phone';\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\n\nexport const ProfileData = ({graphData}) => {\n    return (\n        <List className=\"profileData\">\n            <NameListItem name={graphData.displayName} />\n            <JobTitleListItem jobTitle={graphData.jobTitle} />\n            <MailListItem mail={graphData.mail} />\n            <PhoneListItem phone={graphData.businessPhones[0]} />\n            <LocationListItem location={graphData.officeLocation} />\n        </List>\n    );\n};\n\nconst NameListItem = ({name}) => (\n    <ListItem>\n        <ListItemAvatar>\n            <Avatar>\n                <PersonIcon />\n            </Avatar>\n        </ListItemAvatar>\n        <ListItemText primary=\"Name\" secondary={name}/>\n    </ListItem>\n);\n\nconst JobTitleListItem = ({jobTitle}) => (\n    <ListItem>\n        <ListItemAvatar>\n            <Avatar>\n                <WorkIcon />\n            </Avatar>\n        </ListItemAvatar>\n        <ListItemText primary=\"Title\" secondary={jobTitle}/>\n    </ListItem>\n);\n\nconst MailListItem = ({mail}) => (\n    <ListItem>\n        <ListItemAvatar>\n            <Avatar>\n                <MailIcon />\n            </Avatar>\n        </ListItemAvatar>\n        <ListItemText primary=\"Mail\" secondary={mail}/>\n    </ListItem>\n);\n\nconst PhoneListItem = ({phone}) => (\n    <ListItem>\n        <ListItemAvatar>\n            <Avatar>\n                <PhoneIcon />\n            </Avatar>\n        </ListItemAvatar>\n        <ListItemText primary=\"Phone\" secondary={phone}/>\n    </ListItem>\n);\n\nconst LocationListItem = ({location}) => (\n    <ListItem>\n        <ListItemAvatar>\n            <Avatar>\n                <LocationOnIcon />\n            </Avatar>\n        </ListItemAvatar>\n        <ListItemText primary=\"Location\" secondary={location}/>\n    </ListItem>\n);\n","import React from 'react';\nimport { Typography } from \"@material-ui/core\";\n\nexport const Loading = () => {\n    return <Typography variant=\"h6\">Authentication in progress...</Typography>\n}\n","import React from 'react';\nimport { Typography } from \"@material-ui/core\";\n\nexport const ErrorComponent = ({error}) => {\n    return <Typography variant=\"h6\">An Error Occurred: {error.errorCode}</Typography>;\n}\n","import React, { useEffect, useState } from 'react';\n\n// Msal imports\nimport { MsalAuthenticationTemplate } from '@azure/msal-react';\nimport { InteractionType } from '@azure/msal-browser';\nimport { loginRequest } from '../authConfig';\n\n// API imports\nimport { apiConfig } from '../apiConfig';\n\n// Sample app imports\nimport { ProfileData } from '../ui-components/ProfileData';\nimport { Loading } from '../ui-components/Loading';\nimport { ErrorComponent } from '../ui-components/ErrorComponent';\n\n// Material-ui imports\nimport Paper from '@material-ui/core/Paper';\nimport { useAcquireToken, useGraph } from 'react-msal-wrapper';\nimport { Button } from '@material-ui/core';\n\nconst ProfileContent = () => {\n  const { accessToken } = useAcquireToken({ scopes: apiConfig.scopes });\n  const { graphData } = useGraph();\n  const [accessGranted, setAccessGranted] = useState(false);\n  const [data, setData] = useState(false);\n  const [errorApi, setErrorApi] = useState(null);\n\n  useEffect(() => {\n    const controller = new AbortController();\n    const getDataFromApi = async () => {\n      try {\n        const response = await fetch(apiConfig.apiURL, {\n          method: 'GET',\n          headers: {\n            Authorization: 'Bearer ' + accessToken\n          },\n          signal: controller.signal\n        });\n\n        const body = await response.json();\n\n        if (body?.data?.claims) {\n          setAccessGranted(true);\n          setErrorApi(null);\n          setData(body?.data?.claims);\n        }\n      } catch (error) {\n        setErrorApi(error);\n      }\n    };\n\n    if (accessToken) getDataFromApi();\n\n    return () => controller.abort();\n  }, [accessToken]);\n\n  return (\n    <Paper>\n      {graphData && <ProfileData graphData={graphData} />}\n      <div style={{ textAlign: 'center' }}>\n        <h5>{apiConfig.apiURL}</h5>\n        <Button variant='outlined' color='primary'>\n          {accessGranted ? 'Access Is Granted' : 'Access Not Granted'}\n        </Button>\n        <h5>{errorApi && errorApi?.message}</h5>\n        <h5>{data && JSON.stringify(data)}</h5>\n      </div>\n    </Paper>\n  );\n};\n\nexport function Profile() {\n  const authRequest = {\n    ...loginRequest\n  };\n\n  return (\n    <MsalAuthenticationTemplate\n      interactionType={InteractionType.Popup}\n      authenticationRequest={authRequest}\n      errorComponent={ErrorComponent}\n      loadingComponent={Loading}\n    >\n      <ProfileContent />\n    </MsalAuthenticationTemplate>\n  );\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport useAcquireToken from './useAcquireToken';\n\nfunction useGraph({\n  graphEndpoint = 'https://graph.microsoft.com/v1.0/me'\n} = {}) {\n  const { accessToken } = useAcquireToken({ scopes: ['User.Read'] });\n  const [graphData, setGraphData] = useState(null);\n  const [error, setError] = useState(null);\n\n  const getData = useCallback(\n    async (accessToken, controller) => {\n      try {\n        const response = await fetch(graphEndpoint, {\n          method: 'GET',\n          headers: {\n            Authorization: 'Bearer ' + accessToken\n          },\n          signal: controller.signal\n        });\n        const body = await response.json();\n\n        setGraphData(body);\n      } catch (error) {\n        setError(error);\n      }\n    },\n    [graphEndpoint]\n  );\n\n  useEffect(() => {\n    const controller = new AbortController();\n    if (accessToken) getData(accessToken, controller);\n\n    return () => controller.abort();\n  }, [accessToken, getData]);\n\n  return { graphData, error };\n}\n\nexport default useGraph;\n","import React from 'react';\nimport { BrowserRouter as Router, Switch, Route, useHistory } from \"react-router-dom\";\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport Grid from \"@material-ui/core/Grid\";\n\nimport { theme } from \"./styles/theme\";\nimport { MsalWrapper } from 'react-msal-wrapper';\nimport 'react-msal-wrapper/dist/index.css';\n\nimport { PageLayout } from \"./ui-components/PageLayout\";\n\nimport { Home } from \"./pages/Home\";\nimport { Profile } from \"./pages/Profile.jsx\";\n\nimport { msalConfig } from \"./authConfig\";\nimport { PublicClientApplication } from '@azure/msal-browser';\n\nconst msalInstance = new PublicClientApplication(msalConfig);\n\nconst App = () => {\n  const history = useHistory();\n  // console.log(msalInstance);\n  // console.log(msalConfig);\n\n  return (\n    <Router>\n      <ThemeProvider theme={theme}>\n        <MsalWrapper\n          instance={msalInstance}\n          config={{\n            instanceConfig: msalConfig,\n            router: history\n          }}\n        >\n          <PageLayout>\n            <Grid container justify=\"center\">\n              <Pages />\n            </Grid>\n          </PageLayout>\n        </MsalWrapper>\n      </ThemeProvider>\n    </Router>\n  );\n}\n\nconst Pages = () => {\n  return (\n    <Switch>\n      <Route path=\"/profile\">\n        <Profile />\n      </Route>\n      <Route path=\"/\">\n        <Home />\n      </Route>\n    </Switch>\n  )\n}\n\n// const App = () => {\n//   return (<h1>Example Component</h1>)\n// }\n\nexport default App;\n","// If you need to support IE11 uncomment the imports below\n//import \"react-app-polyfill/ie11\";\n//import \"core-js/stable\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n\nReactDOM.render(\n  // <React.StrictMode>\n  <App />\n  // </React.StrictMode>,\n  , document.getElementById('root')\n);\n"],"sourceRoot":""}